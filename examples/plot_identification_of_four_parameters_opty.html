<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Parameter Identification with Non-Contiguous Measurements. &#8212; Peter&#39;s Mechanics Examples  documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="../_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=9899ed2f" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Time Delay Estimation" href="plot_estimate_time_delay.html" />
    <link rel="prev" title="See the Examples" href="index.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-examples-plot-identification-of-four-parameters-opty-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code.</p>
</div>
<section class="sphx-glr-example-title" id="parameter-identification-with-non-contiguous-measurements">
<span id="sphx-glr-examples-plot-identification-of-four-parameters-opty-py"></span><h1>Parameter Identification with Non-Contiguous Measurements.<a class="headerlink" href="#parameter-identification-with-non-contiguous-measurements" title="Link to this heading">¶</a></h1>
<section id="objective">
<h2>Objective<a class="headerlink" href="#objective" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>Show how to use opty to estimate parameters of a mechanical system from noisy
measurements.</p></li>
<li><p>Show a way to handle explicit time in the equations of motion (very
small point)</p></li>
</ul>
</section>
<section id="description">
<h2>Description<a class="headerlink" href="#description" title="Link to this heading">¶</a></h2>
<p>For parameter estimation it is common to collect measurements of a system’s
trajectories for distinct experiments. For example, if you are identifying the
parameters of a mass-spring-damper system, you will excite the system with
different initial conditions multiple times. The data cannot simply be stacked
and the identification run because the measurement data would be discontinuous
between trials.</p>
<p>A work around in opty is to create a set of differential equations with unique
state variables for each measurement trial that all share the same constant
parameters. You can then identify the parameters from all measurement trials
simultaneously by passing the uncoupled differential equations to opty.</p>
<p>For example:</p>
<p><em>number_of_measurements</em> measurements of the location of a simple system
consisting of a mass connected to a fixed point by a spring and a damper, with
a force = <span class="math notranslate nohighlight">\(F_1 \sin(\omega \cdot t)\)</span> acting on the mass. The movement is
in a horizontal direction. <span class="math notranslate nohighlight">\(c, F_1, k, \omega\)</span> are to be identified.</p>
</section>
<section id="notes">
<h2>Notes<a class="headerlink" href="#notes" title="Link to this heading">¶</a></h2>
<p>This is just a slightly more elaborate version of an example from opty:
<a class="reference external" href="https://opty.readthedocs.io/stable/examples/intermediate/plot_non_contiguous_parameter_identification.html#sphx-glr-examples-intermediate-plot-non-contiguous-parameter-identification-py">https://opty.readthedocs.io/stable/examples/intermediate/plot_non_contiguous_parameter_identification.html#sphx-glr-examples-intermediate-plot-non-contiguous-parameter-identification-py</a></p>
<p><strong>State Variables</strong></p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(x_i\)</span>: position of the mass of the i - th measurement trial [m]</p></li>
<li><p><span class="math notranslate nohighlight">\(u_i\)</span>: speed of the mass of the i - th measurement trial [m/s]</p></li>
</ul>
<p><strong>Parameters</strong></p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(m\)</span>: mass  [kg]</p></li>
<li><p><span class="math notranslate nohighlight">\(c\)</span>: damping coefficient  [Ns/m]</p></li>
<li><p><span class="math notranslate nohighlight">\(k\)</span>: spring constant  [N/m]</p></li>
<li><p><span class="math notranslate nohighlight">\(l_0\)</span>: natural length of the spring [m]</p></li>
<li><p><span class="math notranslate nohighlight">\(F_1\)</span>: amplitude of the force [N]</p></li>
<li><p><span class="math notranslate nohighlight">\(\omega\)</span>: frequency of the force [rad/s]</p></li>
</ul>
<p>Set up the equations of motion and integrate them to get the measurements.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">sympy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sm</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sympy.physics.mechanics</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">me</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.integrate</span><span class="w"> </span><span class="kn">import</span> <span class="n">solve_ivp</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">opty</span><span class="w"> </span><span class="kn">import</span> <span class="n">Problem</span>

<span class="n">number_of_measurements</span> <span class="o">=</span> <span class="mi">15</span>
<span class="n">t0</span><span class="p">,</span> <span class="n">tf</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span>
<span class="n">num_nodes</span> <span class="o">=</span> <span class="mi">400</span>
<span class="n">times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">t0</span><span class="p">,</span> <span class="n">tf</span><span class="p">,</span> <span class="n">num_nodes</span><span class="p">)</span>
<span class="n">t_span</span> <span class="o">=</span> <span class="p">(</span><span class="n">t0</span><span class="p">,</span> <span class="n">tf</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1234</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">dynamicsymbols</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;x:</span><span class="si">{</span><span class="n">number_of_measurements</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">u</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">dynamicsymbols</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;u:</span><span class="si">{</span><span class="n">number_of_measurements</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">fx</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">dynamicsymbols</span><span class="p">(</span><span class="s1">&#39;f_x&#39;</span><span class="p">)</span>
<span class="n">m</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">l0</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;m, c, k, l0&#39;</span><span class="p">)</span>
<span class="n">F1</span><span class="p">,</span> <span class="n">omega</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;F1, omega&#39;</span><span class="p">)</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">dynamicsymbols</span><span class="o">.</span><span class="n">_t</span>
<span class="n">T</span> <span class="o">=</span> <span class="n">me</span><span class="o">.</span><span class="n">dynamicsymbols</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">)</span>

<span class="n">eom1</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">number_of_measurements</span><span class="p">)])</span>
<span class="n">eom2</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([</span><span class="n">m</span><span class="o">*</span><span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="n">c</span><span class="o">*</span><span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">k</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">l0</span><span class="p">)</span> <span class="o">-</span>
                  <span class="n">F1</span><span class="o">*</span><span class="n">sm</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">T</span><span class="p">)</span>
                  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">number_of_measurements</span><span class="p">)])</span>
<span class="n">eom</span> <span class="o">=</span> <span class="n">eom1</span><span class="o">.</span><span class="n">col_join</span><span class="p">(</span><span class="n">eom2</span><span class="p">)</span>
</pre></div>
</div>
<p>Print the equations of motion.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">sm</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">eom</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>⎡                              d                             ⎤
⎢                     -u₀(t) + ──(x₀(t))                     ⎥
⎢                              dt                            ⎥
⎢                                                            ⎥
⎢                              d                             ⎥
⎢                     -u₁(t) + ──(x₁(t))                     ⎥
⎢                              dt                            ⎥
⎢                                                            ⎥
⎢                              d                             ⎥
⎢                     -u₂(t) + ──(x₂(t))                     ⎥
⎢                              dt                            ⎥
⎢                                                            ⎥
⎢                              d                             ⎥
⎢                     -u₃(t) + ──(x₃(t))                     ⎥
⎢                              dt                            ⎥
⎢                                                            ⎥
⎢                              d                             ⎥
⎢                     -u₄(t) + ──(x₄(t))                     ⎥
⎢                              dt                            ⎥
⎢                                                            ⎥
⎢                              d                             ⎥
⎢                     -u₅(t) + ──(x₅(t))                     ⎥
⎢                              dt                            ⎥
⎢                                                            ⎥
⎢                              d                             ⎥
⎢                     -u₆(t) + ──(x₆(t))                     ⎥
⎢                              dt                            ⎥
⎢                                                            ⎥
⎢                              d                             ⎥
⎢                     -u₇(t) + ──(x₇(t))                     ⎥
⎢                              dt                            ⎥
⎢                                                            ⎥
⎢                              d                             ⎥
⎢                     -u₈(t) + ──(x₈(t))                     ⎥
⎢                              dt                            ⎥
⎢                                                            ⎥
⎢                              d                             ⎥
⎢                     -u₉(t) + ──(x₉(t))                     ⎥
⎢                              dt                            ⎥
⎢                                                            ⎥
⎢                              d                             ⎥
⎢                    -u₁₀(t) + ──(x₁₀(t))                    ⎥
⎢                              dt                            ⎥
⎢                                                            ⎥
⎢                              d                             ⎥
⎢                    -u₁₁(t) + ──(x₁₁(t))                    ⎥
⎢                              dt                            ⎥
⎢                                                            ⎥
⎢                              d                             ⎥
⎢                    -u₁₂(t) + ──(x₁₂(t))                    ⎥
⎢                              dt                            ⎥
⎢                                                            ⎥
⎢                              d                             ⎥
⎢                    -u₁₃(t) + ──(x₁₃(t))                    ⎥
⎢                              dt                            ⎥
⎢                                                            ⎥
⎢                              d                             ⎥
⎢                    -u₁₄(t) + ──(x₁₄(t))                    ⎥
⎢                              dt                            ⎥
⎢                                                            ⎥
⎢                                                 d          ⎥
⎢ -F₁⋅sin(ω⋅T(t)) + c⋅u₀(t) + k⋅(-l₀ + x₀(t)) + m⋅──(u₀(t))  ⎥
⎢                                                 dt         ⎥
⎢                                                            ⎥
⎢                                                 d          ⎥
⎢ -F₁⋅sin(ω⋅T(t)) + c⋅u₁(t) + k⋅(-l₀ + x₁(t)) + m⋅──(u₁(t))  ⎥
⎢                                                 dt         ⎥
⎢                                                            ⎥
⎢                                                 d          ⎥
⎢ -F₁⋅sin(ω⋅T(t)) + c⋅u₂(t) + k⋅(-l₀ + x₂(t)) + m⋅──(u₂(t))  ⎥
⎢                                                 dt         ⎥
⎢                                                            ⎥
⎢                                                 d          ⎥
⎢ -F₁⋅sin(ω⋅T(t)) + c⋅u₃(t) + k⋅(-l₀ + x₃(t)) + m⋅──(u₃(t))  ⎥
⎢                                                 dt         ⎥
⎢                                                            ⎥
⎢                                                 d          ⎥
⎢ -F₁⋅sin(ω⋅T(t)) + c⋅u₄(t) + k⋅(-l₀ + x₄(t)) + m⋅──(u₄(t))  ⎥
⎢                                                 dt         ⎥
⎢                                                            ⎥
⎢                                                 d          ⎥
⎢ -F₁⋅sin(ω⋅T(t)) + c⋅u₅(t) + k⋅(-l₀ + x₅(t)) + m⋅──(u₅(t))  ⎥
⎢                                                 dt         ⎥
⎢                                                            ⎥
⎢                                                 d          ⎥
⎢ -F₁⋅sin(ω⋅T(t)) + c⋅u₆(t) + k⋅(-l₀ + x₆(t)) + m⋅──(u₆(t))  ⎥
⎢                                                 dt         ⎥
⎢                                                            ⎥
⎢                                                 d          ⎥
⎢ -F₁⋅sin(ω⋅T(t)) + c⋅u₇(t) + k⋅(-l₀ + x₇(t)) + m⋅──(u₇(t))  ⎥
⎢                                                 dt         ⎥
⎢                                                            ⎥
⎢                                                 d          ⎥
⎢ -F₁⋅sin(ω⋅T(t)) + c⋅u₈(t) + k⋅(-l₀ + x₈(t)) + m⋅──(u₈(t))  ⎥
⎢                                                 dt         ⎥
⎢                                                            ⎥
⎢                                                 d          ⎥
⎢ -F₁⋅sin(ω⋅T(t)) + c⋅u₉(t) + k⋅(-l₀ + x₉(t)) + m⋅──(u₉(t))  ⎥
⎢                                                 dt         ⎥
⎢                                                            ⎥
⎢                                                  d         ⎥
⎢-F₁⋅sin(ω⋅T(t)) + c⋅u₁₀(t) + k⋅(-l₀ + x₁₀(t)) + m⋅──(u₁₀(t))⎥
⎢                                                  dt        ⎥
⎢                                                            ⎥
⎢                                                  d         ⎥
⎢-F₁⋅sin(ω⋅T(t)) + c⋅u₁₁(t) + k⋅(-l₀ + x₁₁(t)) + m⋅──(u₁₁(t))⎥
⎢                                                  dt        ⎥
⎢                                                            ⎥
⎢                                                  d         ⎥
⎢-F₁⋅sin(ω⋅T(t)) + c⋅u₁₂(t) + k⋅(-l₀ + x₁₂(t)) + m⋅──(u₁₂(t))⎥
⎢                                                  dt        ⎥
⎢                                                            ⎥
⎢                                                  d         ⎥
⎢-F₁⋅sin(ω⋅T(t)) + c⋅u₁₃(t) + k⋅(-l₀ + x₁₃(t)) + m⋅──(u₁₃(t))⎥
⎢                                                  dt        ⎥
⎢                                                            ⎥
⎢                                                  d         ⎥
⎢-F₁⋅sin(ω⋅T(t)) + c⋅u₁₄(t) + k⋅(-l₀ + x₁₄(t)) + m⋅──(u₁₄(t))⎥
⎣                                                  dt        ⎦
</pre></div>
</div>
<p>Equations of motion for the solve_ivp integration.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">rhs1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">number_of_measurements</span><span class="p">)])</span>
<span class="n">rhs2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="o">/</span><span class="n">m</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="n">c</span><span class="o">*</span><span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">k</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">l0</span><span class="p">)</span> <span class="o">+</span> <span class="n">F1</span><span class="o">*</span><span class="n">sm</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span><span class="p">))</span>
                 <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">number_of_measurements</span><span class="p">)])</span>
<span class="n">rhs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">rhs1</span><span class="p">,</span> <span class="n">rhs2</span><span class="p">))</span>

<span class="n">qL</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">u</span>
<span class="n">pL</span> <span class="o">=</span> <span class="p">[</span><span class="n">m</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">l0</span><span class="p">,</span> <span class="n">F1</span><span class="p">,</span> <span class="n">omega</span><span class="p">,</span> <span class="n">t</span><span class="p">]</span>

<span class="n">rhs_lam</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">lambdify</span><span class="p">(</span><span class="n">qL</span> <span class="o">+</span> <span class="n">pL</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">gradient</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">args</span><span class="p">):</span>
    <span class="n">args</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span>
    <span class="k">return</span> <span class="n">rhs_lam</span><span class="p">(</span><span class="o">*</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">number_of_measurements</span><span class="p">)</span>


<span class="c1"># Different initial conditions for the different measurements.</span>
<span class="n">x0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">i</span> <span class="o">/</span> <span class="mi">4</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">number_of_measurements</span><span class="p">)]</span> <span class="o">+</span>
              <span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">number_of_measurements</span><span class="p">)])</span>
<span class="n">pL_vals</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">6.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="n">t0</span><span class="p">]</span>

<span class="n">resultat1</span> <span class="o">=</span> <span class="n">solve_ivp</span><span class="p">(</span><span class="n">gradient</span><span class="p">,</span> <span class="n">t_span</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">t_eval</span><span class="o">=</span><span class="n">times</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">pL_vals</span><span class="p">,))</span>
<span class="n">resultat</span> <span class="o">=</span> <span class="n">resultat1</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
<p>Create the noisy measurements: simply add noise to the results of the
integration.It is assumed, that only the locations are measured, not the
speeds.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">measurements</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">number_of_measurements</span><span class="p">):</span>
    <span class="n">measurements</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">resultat</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">resultat</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span>
                        <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">i</span> <span class="o">/</span> <span class="mi">20</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1.0</span> <span class="o">/</span>
                        <span class="p">(</span><span class="n">i</span> <span class="o">/</span> <span class="mi">20</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</section>
<section id="set-up-the-estimation-problem">
<h2>Set up the Estimation Problem.<a class="headerlink" href="#set-up-the-estimation-problem" title="Link to this heading">¶</a></h2>
<p>The idea is Gauss’ method of least squares:
<a class="reference external" href="https://en.wikipedia.org/wiki/Least_squares">https://en.wikipedia.org/wiki/Least_squares</a></p>
<p>If some measurement is considered more reliable, its weight w may be
increased.</p>
<p>objective = <span class="math notranslate nohighlight">\(\int_{t_0}^{t_f} \left[ \sum_{i=1}^{
\textrm{number_of_measurements}} (w_i \cdot (x_i - x_i^m)^2 \right] dt\)</span></p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># This is added to get the explicit time for opty.</span>
<span class="n">eom</span> <span class="o">=</span> <span class="n">eom</span><span class="o">.</span><span class="n">col_join</span><span class="p">(</span><span class="n">sm</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([</span><span class="n">T</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]))</span>
<span class="n">state_symbols</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">u</span> <span class="o">+</span> <span class="p">[</span><span class="n">T</span><span class="p">]</span>

<span class="n">interval_value</span> <span class="o">=</span> <span class="p">(</span><span class="n">tf</span> <span class="o">-</span> <span class="n">t0</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">num_nodes</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">par_map</span> <span class="o">=</span> <span class="p">{</span><span class="n">m</span><span class="p">:</span> <span class="n">pL_vals</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
           <span class="n">l0</span><span class="p">:</span> <span class="n">pL_vals</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
           <span class="p">}</span>

<span class="c1"># Weight vector. Here measurements with higher order number are considered</span>
<span class="c1"># more reliable, so their weight is set to be larger.</span>
<span class="n">w</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span> <span class="o">+</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">number_of_measurements</span><span class="p">)]</span>


<span class="k">def</span><span class="w"> </span><span class="nf">obj</span><span class="p">(</span><span class="n">free</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">interval_value</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">([</span><span class="n">w</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span>
        <span class="p">(</span><span class="n">free</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="n">num_nodes</span><span class="p">:(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">num_nodes</span><span class="p">]</span> <span class="o">-</span> <span class="n">measurements</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">number_of_measurements</span><span class="p">)])</span>


<span class="k">def</span><span class="w"> </span><span class="nf">obj_grad</span><span class="p">(</span><span class="n">free</span><span class="p">):</span>
    <span class="n">grad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">free</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">number_of_measurements</span><span class="p">):</span>
        <span class="n">grad</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="n">num_nodes</span><span class="p">:</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">num_nodes</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">w</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">interval_value</span><span class="o">*</span><span class="p">(</span>
            <span class="n">free</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="n">num_nodes</span><span class="p">:(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">num_nodes</span><span class="p">]</span> <span class="o">-</span> <span class="n">measurements</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="n">grad</span>


<span class="n">bounds</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">c</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="n">k</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
    <span class="n">F1</span><span class="p">:</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
    <span class="n">omega</span><span class="p">:</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span>
<span class="p">}</span>

<span class="n">instance_constraints</span> <span class="o">=</span> <span class="p">(</span>
                        <span class="n">T</span><span class="o">.</span><span class="n">func</span><span class="p">(</span><span class="n">t0</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.0</span><span class="p">,</span>
                        <span class="p">)</span>

<span class="n">problem</span> <span class="o">=</span> <span class="n">Problem</span><span class="p">(</span>
    <span class="n">obj</span><span class="p">,</span>
    <span class="n">obj_grad</span><span class="p">,</span>
    <span class="n">eom</span><span class="p">,</span>
    <span class="n">state_symbols</span><span class="p">,</span>
    <span class="n">num_nodes</span><span class="p">,</span>
    <span class="n">interval_value</span><span class="p">,</span>
    <span class="n">known_parameter_map</span><span class="o">=</span><span class="n">par_map</span><span class="p">,</span>
    <span class="n">instance_constraints</span><span class="o">=</span><span class="n">instance_constraints</span><span class="p">,</span>
    <span class="n">bounds</span><span class="o">=</span><span class="n">bounds</span><span class="p">,</span>
    <span class="n">time_symbol</span><span class="o">=</span><span class="n">me</span><span class="o">.</span><span class="n">dynamicsymbols</span><span class="o">.</span><span class="n">_t</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p>This gives the unknown parameters, and their sequence in the solution vector.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;unknown parameters are:&#39;</span><span class="p">,</span> <span class="n">problem</span><span class="o">.</span><span class="n">collocator</span><span class="o">.</span><span class="n">unknown_parameters</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>unknown parameters are: (F1, c, k, omega)
</pre></div>
</div>
<p>Initial guess.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">list1</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">measurements</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">number_of_measurements</span><span class="p">)]</span>
<span class="n">list1</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">list1</span><span class="p">)</span><span class="o">.</span><span class="n">flat</span><span class="p">)</span>
<span class="n">initial_guess</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
    <span class="n">list1</span>
    <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">number_of_measurements</span><span class="o">*</span><span class="n">num_nodes</span><span class="p">))</span>
    <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">t0</span><span class="p">,</span> <span class="n">tf</span><span class="p">,</span> <span class="n">num_nodes</span><span class="p">))</span>
    <span class="o">+</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Solve the Optimization Problem.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">solution</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">problem</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">initial_guess</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;status_msg&#39;</span><span class="p">])</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">problem</span><span class="o">.</span><span class="n">plot_objective_value</span><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_plot_identification_of_four_parameters_opty_001.png" srcset="../_images/sphx_glr_plot_identification_of_four_parameters_opty_001.png" alt="Objective Value" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>b&#39;Algorithm terminated successfully at a locally optimal point, satisfying the convergence tolerances (can be specified by options).&#39;
</pre></div>
</div>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">_</span> <span class="o">=</span> <span class="n">problem</span><span class="o">.</span><span class="n">plot_constraint_violations</span><span class="p">(</span><span class="n">solution</span><span class="p">)</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_plot_identification_of_four_parameters_opty_002.png" srcset="../_images/sphx_glr_plot_identification_of_four_parameters_opty_002.png" alt="Constraint violations" class = "sphx-glr-single-img"/></section>
<section id="results-obtained">
<h2>Results obtained<a class="headerlink" href="#results-obtained" title="Link to this heading">¶</a></h2>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;As the true values are known in this example, an error can be given&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Estimate of dampening constant is </span><span class="si">{</span><span class="n">solution</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> error is &#39;</span>
      <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="p">(</span><span class="n">solution</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">pL_vals</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="n">pL_vals</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> %&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Estimate of spring constant is    </span><span class="si">{</span><span class="n">solution</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> error is &#39;</span>
      <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="p">(</span><span class="n">solution</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">pL_vals</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">/</span><span class="n">pL_vals</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> %&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Estimate of force is              </span><span class="si">{</span><span class="n">solution</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> error is &#39;</span>
      <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="p">(</span><span class="n">solution</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">pL_vals</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span><span class="o">/</span><span class="n">pL_vals</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> %&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Estimate of the frequency is      </span><span class="si">{</span><span class="n">solution</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> error is &#39;</span>
      <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="p">(</span><span class="n">solution</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">pL_vals</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span><span class="o">/</span><span class="n">pL_vals</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> %&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>As the true values are known in this example, an error can be given
Estimate of dampening constant is 0.21 error is -14.30 %
Estimate of spring constant is    1.98 error is -1.01 %
Estimate of force is              5.93 error is -1.25 %
Estimate of the frequency is      2.99 error is -0.48 %
</pre></div>
</div>
<p>Plot the measurements.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">number_of_measurements</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>
                       <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mf">1.25</span> <span class="o">*</span> <span class="n">number_of_measurements</span><span class="p">),</span>
                       <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="s1">&#39;constrained&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">number_of_measurements</span><span class="p">):</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">measurements</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Set - </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1"> [m]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Measurements&#39;</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time [sec]&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_plot_identification_of_four_parameters_opty_003.png" srcset="../_images/sphx_glr_plot_identification_of_four_parameters_opty_003.png" alt="Measurements" class = "sphx-glr-single-img"/><p class="sphx-glr-timing"><strong>Total running time of the script:</strong> (0 minutes 22.450 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-examples-plot-identification-of-four-parameters-opty-py">
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../_downloads/9f9dd3ac6bb0f379e5214fccd703dbb3/plot_identification_of_four_parameters_opty.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_identification_of_four_parameters_opty.ipynb</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../_downloads/12892810729c8927605cd55fc940d7b7/plot_identification_of_four_parameters_opty.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_identification_of_four_parameters_opty.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-zip docutils container">
<p><a class="reference download internal" download="" href="../_downloads/76cf286d2c4d8d43696c657d4a345015/plot_identification_of_four_parameters_opty.zip"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">zipped:</span> <span class="pre">plot_identification_of_four_parameters_opty.zip</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">Peter's Mechanics Examples</a></h1>






<p>
<iframe src="https://ghbtns.com/github-btn.html?user=pydy&repo=pst-notebooks&type=star&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>






<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">See the Examples</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Parameter Identification with Non-Contiguous Measurements.</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_estimate_time_delay.html">Time Delay Estimation</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_block_on_disc_coulomb_friction.html">Block Sliding on a Spinning Disc</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_brachi_shift_hack_inequality_opty.html">Brachistochrone</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_balancing_wheel.html">Automatic Balancing of a Wheel</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_T_handle.html">Rotating T-handle</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_particle_gates_h_opty.html">Particle Through Gates</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_car_hits_points.html">Car hits Points</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_synchronisation.html">Synchronisation of Clocks</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_two_body_skateboard.html">Two Body Skateboard</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_wood_pecker.html">Wood Pecker</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_chain_link_closed.html">Closed Chain</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_3d_drone_propeller.html">3D Drone with Propellers</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_spoked_wheel.html">Spoked, Rimless Wheel</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_ball_bouncing_between_two_horizontal_planes.html">Ball bouncing between two planes</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_ellipse_bouncing_on_street_HC_theory.html">Bouncing Ellipse</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_hc_colliding_discs_friction_circle.html">Colliding Discs</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_hc_rolling_balls_uneven_street.html">Two Balls Rolling on an Uneven Street</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_hc_colliding_ellipses_circle.html">Colliding Ellipses</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="index.html">See the Examples</a><ul>
      <li>Previous: <a href="index.html" title="previous chapter">See the Examples</a></li>
      <li>Next: <a href="plot_estimate_time_delay.html" title="next chapter">Time Delay Estimation</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2025, Peter Stahlecker.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.2.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="../_sources/examples/plot_identification_of_four_parameters_opty.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>